!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Ebanx=t():e.Ebanx=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){var e={},t={mode:"test"};return e.config=function(){return{isLive:"production"===t.mode,setPublishableKey:function(e){n.validator.config.validatePublishableKey(e),t.publicKey=e},getPublishableKey:function(){return t.publicKey}}}(),e}();n.errors=function(){return{invalidValueField:function(e,t){this.message=e,this.field=t,this.name="invalidValueField"}}}(),n.validator=function(){return{config:{validatePublishableKey:function(e){var t=new RegExp("^[0-9]{7}$");if(!t.test(e))throw new n.errors.invalidValueField("Invalid PublishableKey.","PublishableKey")}},card:{validateNumber:function(e){var t=new RegExp("^[0-9]{16}$");if(!t.test(e)||!this.luhnAlgCheck(e))throw new n.errors.invalidValueField("Invalid card number.","card_number")},luhnAlgCheck:function(e){e=(e+"").replace(/\s+|-/g,"");for(var t=0,r=0;r<e.length;r++){var n=parseInt(e.substr(r,1));r%2===0&&(n*=2,n>9&&(n=1+n%10)),t+=n}return t%10===0},validateCvv:function(e){var t=new RegExp("^[0-9]{3}$");if(!t.test(e))throw new n.errors.invalidValueField("Invalid card cvv.","card_cvv")},validateDueDate:function(e){var t=(e+"").split("/");if(t={now:new Date,year:t[1],month:t[0]},/^\d+$/.test(t.month)!==!0||parseInt(t.month,10)<=12!=!0)throw new n.errors.invalidValueField("Invalid month to card due_date.","card_due_date");if(!/^\d+$/.test(t.year))throw new n.errors.invalidValueField("Invalid year to card due_date.","card_due_date");if(t.expiration=new Date(t.year,t.month),t.expiration.setMonth(t.expiration.getMonth()-1),t.expiration.setMonth(t.expiration.getMonth()+1,1),t.expiration>t.now!=!0)throw new n.errors.invalidValueField("Invalid card due_date.","card_due_date")},validate:function(e){this.validateCvv(e.card_cvv),this.validateNumber(e.card_number),this.validateDueDate(e.card_due_date)}}}}(),n.tokenize=function(){return{card:{token:function(e,t){var r=n.utils.api.resources.createToken;n.http.ajax.request({url:r.url,method:r.method,json:!0,data:e}).done(function(e){t(e.body)}).fail(function(e){console.log("failllllllllllll",e),response.error=e})}},boleto:{}}}(),n.utils=function(){var e={api:{url:(n.config.isLive,"http://dev-pay.ebanx.com/ws/merchantSettlement/")}};return e.api.resources={createToken:{url:e.api.url+"getExtract",method:"post"}},e}(),n.http=function(){return{normalize:{q:function(e,t){var r,n=[];for(var a in e)n.push(a+"="+encodeURIComponent(e[a]));return r=n.join("&"),""!==r?t?t.indexOf("?")<0?"?"+r:"&"+r:r:""}},ajax:{request:function(e){"string"==typeof e&&(e={url:e}),e.url=e.url||"",e.method=e.method||"get",e.data=e.data||{};var t={host:{},process:function(e){var t=this;return this.xhr=null,window.ActiveXObject?this.xhr=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.xhr&&(this.xhr.onreadystatechange=function(){if(4==t.xhr.readyState&&200==t.xhr.status){var r=t.xhr.responseText;e.json===!0&&"undefined"!=typeof JSON&&(r=JSON.parse(r)),t.doneCallback&&t.doneCallback.apply(t.host,[r,t.xhr])}else 4==t.xhr.readyState&&t.failCallback&&t.failCallback.apply(t.host,[t.xhr]);t.alwaysCallback&&t.alwaysCallback.apply(t.host,[t.xhr])}),"get"==e.method?this.xhr.open("GET",e.url+n.http.normalize.q(e.data,e.url),!0):(this.xhr.open(e.method,e.url,!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"})),e.headers&&"object"==r(e.headers)&&this.setHeaders(e.headers),setTimeout(function(){"get"==e.method?t.xhr.send():t.xhr.send(n.http.ajax.request(e.data))},20),this},done:function(e){return this.doneCallback=e,this},fail:function(e){return this.failCallback=e,this},always:function(e){return this.alwaysCallback=e,this},setHeaders:function(e){for(var t in e)this.xhr&&this.xhr.setRequestHeader(t,e[t])}};return t.process(e)}}}}(),n.card=function(){var e={};return e.createToken=function(e,t){var r={token:{},error:{}};try{n.validator.card.validate(e),n.tokenize.card.token(e,function(e){r.token=e,t(r)})}catch(a){return a instanceof n.errors.invalidValueField,r.error.err=a,t(r)}},e}(),e.exports=n}])});